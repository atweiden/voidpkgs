maintainer="nox"
pkgname="nvme-cli"
version=2.0
revision=1
short_desc="NVMe management command line interface"
makedepends+=" json-c-devel"
makedepends+=" libhugetlbfs-devel"
makedepends+=" libnvme-devel"
makedepends+=" libuuid-devel"
makedepends+=" zlib-devel"
hostmakedepends="pkg-config"
homepage="http://nvmexpress.org"
license="GPL-2.0-only"
distfiles="https://github.com/linux-nvme/nvme-cli/archive/v$version.tar.gz>$pkgname-$version.tar.gz"
checksum="471869b3bf643bb357dc9613ad14d24ff342fcd97e2db5a753c81c335ad8859c"
conf_files="/etc/nvme/*.conf"
build_style="meson"
configure_args+=" -Ddocs=man"
configure_args+=" -Dudevrulesdir=lib/udev/rules.d"

post_install() {
  # remove files that are systemd-only
  rm -rf "$DESTDIR/usr/lib/systemd"
  # calls systemctl
  rm -rf "$DESTDIR/usr/lib/udev/rules.d/70-nvmf-autoconnect.rules"
  # needs 70-nvmf-autoconnect.rules
  rm -rf "$DESTDIR/usr/lib/dracut/dracut.conf.d/70-nvmf-autoconnect.conf"
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
