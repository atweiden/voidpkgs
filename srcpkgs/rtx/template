maintainer="nox"
pkgname="rtx"
version=1.29.6
revision=1
short_desc="Polyglot runtime manager (asdf rust clone)"
homepage="https://github.com/jdxcode/rtx"
license="MIT"
changelog="https://github.com/jdxcode/rtx/releases"
distfiles="https://github.com/jdxcode/rtx/archive/v$version.tar.gz>$pkgname-$version.tar.gz"
checksum="2bd6747c8f871d8db5c727b92358936de490e7b98aca9ed2ada39c99c7bcad8c"
build_style="cargo"
# skip cli tests: fail to find executable
make_check_args="-- --skip cli::direnv::exec::tests"
# shell completion generation requires qemu (see: upstream)
nocross="yes"

post_install() {
  vlicense LICENSE
  vdoc README.md
  # build shell completions without cross-platform support (see: upstream)
  "$DESTDIR/usr/bin/rtx" completion bash > rtx.bash
  "$DESTDIR/usr/bin/rtx" completion fish > rtx.fish
  "$DESTDIR/usr/bin/rtx" completion zsh > _rtx
  vcompletion rtx.bash bash rtx
  vcompletion rtx.fish fish rtx
  vcompletion _rtx zsh rtx
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
