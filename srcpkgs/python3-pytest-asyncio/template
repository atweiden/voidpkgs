maintainer="nox"
pkgname="python3-pytest-asyncio"
version=0.19.0
revision=1
short_desc="Pytest support for asyncio"
depends="python3-pytest"
checkdepends+=" python3-hypothesis"
checkdepends+=" python3-pytest"
hostmakedepends+=" python3-setuptools_scm"
hostmakedepends+=" python3-wheel"
homepage="https://github.com/pytest-dev/pytest-asyncio"
license="Apache-2.0"
distfiles="$PYPI_SITE/p/pytest-asyncio/pytest-asyncio-$version.tar.gz"
checksum="ac4ebf3b6207259750bc32f4c1d8fcd7e79739edbc67ad0c58dd150b1d072fed"
wrksrc="pytest-asyncio-$version"
build_style="python3-pep517"

do_check() {
  local skiptests

  skiptests+=" test_auto_mode_cmdline or"
  skiptests+=" test_strict_mode_ignores_trio_fixtures or"
  skiptests+=" test_unused_port_fixture or"
  skiptests+=" test_unused_port_factory_fixture"

  PYTHONPATH="$(cd build/lib* && pwd)" \
    python3 -m pytest -k "not ($skiptests)"
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
