maintainer="nox"
pkgname="cargo-deny"
version=0.13.5
revision=1
_adv_gitrev="222ccf84ef7d733a6eac71f694a5e14b4d0d0289"
short_desc="Cargo plugin to help you manage large dependency graphs"
makedepends="openssl-devel"
hostmakedepends="pkg-config"
homepage="https://github.com/EmbarkStudios/cargo-deny"
license="MIT, Apache-2.0"
changelog="https://github.com/EmbarkStudios/cargo-deny/raw/main/CHANGELOG.md"
distfiles="https://github.com/EmbarkStudios/cargo-deny/archive/$version.tar.gz>$pkgname-$version.tar.gz"
checksum="aebfff46cf510fc9a85ce0059e88792c6467f44c17dd29badce50a13af47e4f7"
build_style="cargo"
configure_args="--no-default-features"

if [[ "$XBPS_TARGET_ENDIAN" == "be" ]]; then
  broken="bitvec crate unimplemented for big endian"
fi

pre_check() {
  rm -rf tests/advisory-db/github.com-2f857891b7f43c59
  /usr/libexec/chroot-git/git clone https://github.com/rustsec/advisory-db.git tests/advisory-db/github.com-2f857891b7f43c59
  cd tests/advisory-db/github.com-2f857891b7f43c59
  /usr/libexec/chroot-git/git checkout "$_adv_gitrev"
}

post_install() {
  vlicense LICENSE-APACHE
  vlicense LICENSE-MIT
  vdoc README.md
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
