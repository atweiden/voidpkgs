maintainer="nox"
pkgname="irssi"
version=1.2.2
revision=2
short_desc="Secure and modular IRC client with text mode user interface"
depends="ca-certificates"
makedepends+=" libgcrypt-devel"
makedepends+=" libglib-devel"
makedepends+=" libotr-devel"
makedepends+=" libressl-devel"
makedepends+=" ncurses-devel"
hostmakedepends="pkg-config"
homepage="https://www.irssi.org"
license="GPL-2.0-or-later"
distfiles="https://github.com/irssi/irssi/releases/download/$version/$pkgname-$version.tar.gz"
checksum="53182861d4d2be6db35fa7e3f0524a64d2a54a374307574dab5f5362bfea563c"
conf_files="/etc/irssi.conf"
build_style="gnu-configure"
configure_args+=" --disable-static"
configure_args+=" --enable-true-color"
configure_args+=" --with-otr"
configure_args+=" --with-proxy"
subpackages+=" irssi-devel"
subpackages+=" irssi-otr"

LDFLAGS="-lncursesw"

if [[ -z "$CROSS_BUILD" ]]; then
  configure_args+=" --with-perl=module"
  subpackages+=" irssi-perl"
  makedepends+=" perl"
fi

irssi-perl_package() {
  depends="irssi"
  short_desc+=" - perl support"
  pkg_install() {
    vmove usr/lib/perl5
    vmove "usr/lib/irssi/modules/*perl*"
    vmove usr/share/irssi/scripts
  }
}

irssi-otr_package() {
  depends="irssi"
  short_desc+=" - OTR support"
  pkg_install() {
    vmove "usr/lib/irssi/modules/*otr*"
  }
}

irssi-devel_package() {
  depends="$makedepends"
  short_desc+=" - development files"
  pkg_install() {
    vmove usr/include
  }
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
