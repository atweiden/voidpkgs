maintainer="nox"
pkgname="lnd"
version=0.14.1beta
revision=1
short_desc="Lightning Network Daemon"
tags+=" btcsuite"
tags+=" lightningnetwork"
homepage="https://github.com/lightningnetwork/lnd"
license="MIT"
distfiles+=" https://github.com/lightningnetwork/lnd/releases/download/v${version%beta}-beta/$pkgname-source-v${version%beta}-beta.tar.gz"
distfiles+=" https://github.com/lightningnetwork/lnd/releases/download/v${version%beta}-beta/vendor.tar.gz"
checksum+=" c4cb0ae4ec3fdb311a3d907374be8c0fa92ec9b3862ab4cdf76103912a51d5e6"
checksum+=" 3582af767576b12e978b849173776e6b40a7066fab83e3b7c51540c441949a84"
wrksrc="$pkgname-v${version%beta}-beta"
create_wrksrc="yes"
build_style="go"
go_import_path="github.com/lightningnetwork/lnd"
go_package+=" $go_import_path"
go_package+=" $go_import_path/cmd/lnd"
go_package+=" $go_import_path/cmd/lncli"
go_mod_mode="vendor"
go_ldflags+=" -s -w -buildid="
go_ldflags+=" -X $go_import_path/build.Commit=v${version%beta}-beta"

broken="cannot use cli.StringFlag{...} (type cli.StringFlag) as type cli.Flag in slice literal"

export CGO_ENABLED=0
export GOFLAGS="-trimpath"

do_configure() {
  # upstream ships required dependencies
  ln -s "$wrksrc/vendor" "$GOPATH"
}

post_install() {
  vlicense LICENSE
  vdoc README.md
  vdoc sample-lnd.conf
  vcopy docs "usr/share/doc/$pkgname"
  vinstall contrib/lncli.bash-completion 0644 usr/share/bash-completion/completions lncli
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
