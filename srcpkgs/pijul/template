maintainer="nox"
pkgname="pijul"
version=0.12.2
revision=1
short_desc="Distributed version control system based on patches"
makedepends+=" libressl-devel"
makedepends+=" libsodium-devel"
makedepends+=" nettle-devel"
hostmakedepends+=" clang"
hostmakedepends+=" pkg-config"
homepage="https://pijul.org/"
license="GPL-2.0-only"
distfiles="https://crates.io/api/v1/crates/pijul/$version/download>$pkgname-$version.tar.gz"
checksum="f92a3f4063e780ca45c161ceb0f42baf34dfeddf3359ebf6c2e0442d9abb5889"
build_style="cargo"

if [[ -n "$CROSS_BUILD" ]]; then
  export HOST_CC="$BUILD_CC"
  export HOST_CFLAGS="$BUILD_CFLAGS"
  export BINDGEN_EXTRA_CLANG_ARGS="--sysroot=$XBPS_CROSS_BASE"
fi

# we only want to install the binary, so don't run cargo install
do_install() {
  vbin "target/$RUST_TARGET/release/pijul"
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
