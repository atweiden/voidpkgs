maintainer="nox"
pkgname="hashcat"
version=6.0.0
revision=1
short_desc="Advanced CPU-based password recovery utility"
makedepends+=" opencl2-headers"
makedepends+=" xxHash-devel"
checkdepends="perl"
homepage="https://hashcat.net/hashcat/"
license="MIT"
changelog="https://github.com/hashcat/hashcat/raw/master/docs/changes.txt"
distfiles="https://hashcat.net/files/hashcat-$version.tar.gz"
checksum="e8e70f2a5a608a4e224ccf847ad2b8e4d68286900296afe00eb514d8c9ec1285"
build_style="gnu-makefile"
make_build_args+=" DEPS_OPENCL_PATH=$XBPS_CROSS_BASE/usr/include"
make_build_args+=" DEPS_XXHASH_PATH=$XBPS_CROSS_BASE/usr/include"
make_build_args+=" PREFIX=/usr"
make_build_args+=" SHARED_FOLDER=/usr/lib/hashcat"
make_build_args+=" USE_SYSTEM_OPENCL=1"
make_build_args+=" USE_SYSTEM_XXHASH=1"
make_use_env="yes"
make_install_args="$make_build_args"

if [[ "$XBPS_TARGET_ENDIAN" == "be" ]]; then
  broken="Not supported on big endian"
fi

post_extract() {
  vsed \
    -i \
    -e '/^CC/d' \
    src/Makefile
}

post_install() {
  rm -f "$DESTDIR/usr/share/docs/hashcat/license.txt"
  vlicense docs/license.txt
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
