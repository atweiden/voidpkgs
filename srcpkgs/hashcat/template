maintainer="nox"
pkgname="hashcat"
version=5.1.0
revision=1
short_desc="Advanced CPU-based password recovery utility"
makedepends+=" gmp-devel"
makedepends+=" opencl2-headers"
makedepends+=" xxHash-devel"
checkdepends="perl"
homepage="https://hashcat.net/hashcat/"
license="MIT"
changelog="https://github.com/hashcat/hashcat/raw/master/docs/changes.txt"
distfiles="https://hashcat.net/files/hashcat-$version.tar.gz"
checksum="283beaa68e1eab41de080a58bb92349c8e47a2bb1b93d10f36ea30f418f1e338"
build_style="gnu-makefile"
make_build_args+=" DEPS_OPENCL_PATH=$XBPS_CROSS_BASE/usr/include"
make_build_args+=" DEPS_XXHASH_PATH=$XBPS_CROSS_BASE/usr/include"
make_build_args+=" PREFIX=/usr"
make_build_args+=" USE_SYSTEM_OPENCL=1"
make_build_args+=" USE_SYSTEM_XXHASH=1"
make_use_env="yes"

if [[ "$XBPS_TARGET_ENDIAN" == "be" ]]; then
  broken="Not supported on big endian"
fi

post_extract() {
  sed \
    -i \
    -e '/^CC/d' \
    src/Makefile
}

post_install() {
  rm -f "$DESTDIR/usr/share/docs/hashcat/license.txt"
  vlicense docs/license.txt
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
