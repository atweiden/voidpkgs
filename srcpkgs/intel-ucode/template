maintainer="Andy Weidenbaum <archbaum@gmail.com>"
pkgname="intel-ucode"
version=20191112
revision=1
short_desc="Microcode update files for Intel CPUs"
archs+=" i686*"
archs+=" x86_64*"
homepage="https://github.com/intel/Intel-Linux-Processor-Microcode-Data-Files"
license="custom: Proprietary"
distfiles="https://github.com/intel/Intel-Linux-Processor-Microcode-Data-Files/archive/microcode-$version.tar.gz>$pkgname-$version.tar.gz"
checksum="0000f7cf96f2b07a1ba9d1fc0bcfcb49d0edb91f7d487a57a88c147e57c5873b"
wrksrc="Intel-Linux-Processor-Microcode-Data-Files-microcode-$version"
repository="nonfree"

do_install() {
  vmkdir usr/lib/firmware/intel-ucode
  vcopy "intel-ucode/*" usr/lib/firmware/intel-ucode
  vmkdir usr/lib/dracut/dracut.conf.d
  echo "early_microcode=yes" >> \
    "$DESTDIR/usr/lib/dracut/dracut.conf.d/intel_ucode.conf"
}

post_install() {
  vlicense license
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
