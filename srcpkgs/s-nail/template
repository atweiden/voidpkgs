maintainer="nox"
pkgname="s-nail"
version=14.8.16
revision=8
short_desc="Mail processing system with a command syntax reminiscent of ed"
makedepends+=" libidn2-devel"
makedepends+=" libressl-devel"
homepage="https://git.sdaoden.eu/cgit/s-nail.git"
license="BSD"
distfiles="https://www.sdaoden.eu/downloads/s-nail-$version.tar.xz"
checksum="9b6123499eea070d6f6c242661aed1522826d9fa78abc26d55e5dc2339b959df"
conf_files="/etc/s-nail.rc"
provides="mail-${version}_$revision"
alternatives+=" mail:mail.1:/usr/share/man/man1/s-nail.1"
alternatives+=" mail:mail.rc:/etc/s-nail.rc"
alternatives+=" mail:mail:/usr/bin/s-nail"

do_build() {
  make \
    BINDIR="/usr/bin" \
    CC="$CC" \
    MAILSPOOL="/var/spool/mail" \
    MANDIR="/usr/share/man" \
    NAIL="mail" \
    PREFIX="/usr" \
    SENDMAIL="/usr/bin/sendmail" \
    SID= \
    SYSCONFDIR="/etc" \
    WANT_AUTOCC=0 \
    WANT_FILTER_HTML_TAGSOUP=1 \
    WANT_IDNA=1 \
    XPAGER="less" \
    config
  make \
    CC="$CC" \
    "$makejobs" \
    build
}

do_install() {
  make \
    DESTDIR="$DESTDIR" \
    packager-install
  mv "$DESTDIR/etc"/{mail,$pkgname}.rc
  mv "$DESTDIR/usr/bin"/{mail,$pkgname}
  mv "$DESTDIR/usr/share/man/man1"/{mail,$pkgname}.1
  vlicense COPYING
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
