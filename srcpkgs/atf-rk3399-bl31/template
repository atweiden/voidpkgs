maintainer="nox"
pkgname="atf-rk3399-bl31"
version=2.4
revision=1
short_desc="ARM Trusted Firmware for Rockchip rk3399 boards (ARMv8, bl31 option)"
archs="aarch64*"
hostmakedepends="cross-arm-none-eabi"
homepage="https://developer.trustedfirmware.org/dashboard/view/6/"
license="BSD-3-Clause"
distfiles="https://git.trustedfirmware.org/TF-A/trusted-firmware-a.git/snapshot/trusted-firmware-a-$version.tar.gz"
checksum="bf3eb3617a74cddd7fb0e0eacbfe38c3258ee07d4c8ed730deef7a175cc3d55b"
wrksrc="trusted-firmware-a-$version"
nostrip="yes"

do_build() {
  unset CFLAGS
  unset CPPFLAGS
  unset CXXFLAGS
  unset LDFLAGS
  if [[ -n "$CROSS_BUILD" ]]; then
    export CROSS_COMPILE="$XBPS_CROSS_TRIPLET-"
  fi
  make "$makejobs" PLAT="rk3399" bl31
}

do_install() {
  vinstall build/rk3399/release/bl31/bl31.elf 0755 usr/lib/trusted-firmware-a/rk3399
  vlicense docs/license.rst
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
