maintainer="Andy Weidenbaum <archbaum@gmail.com>"
pkgname="zig"
version=0.3.0
revision=1
short_desc="A programming language designed for robustness, optimality, and clarity"
makedepends+=" clang"
makedepends+=" libxml2-devel"
makedepends+=" llvm"
makedepends+=" ncurses-devel"
makedepends+=" zlib-devel"
homepage="https://ziglang.org"
license="MIT"
distfiles="https://github.com/ziglang/zig/archive/$version.tar.gz"
checksum="23ebb962823b2c78fd7bb16dd033b189c3050eee9991070debbd79c9b8648772"
patch_args="-Np1"
build_style="cmake"
configure_args+=" -DZIG_LIBC_LIB_DIR=$(dirname $(cc -print-file-name=crt1.o))"
configure_args+=" -DZIG_LIBC_INCLUDE_DIR=$(echo -n | cc -E -x c - -v 2>&1 | grep -B1 "End of search list." | head -n1 | cut -c 2-)"
configure_args+=" -DZIG_LIBC_STATIC_LIB_DIR=$(dirname $(cc -print-file-name=crtbegin.o))"

do_check() {
  bin/zig build --build-file ../build.zig test
}

post_install() {
  vlicense LICENSE
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
