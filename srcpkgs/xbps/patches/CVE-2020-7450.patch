commit cf20e53d34446bcf8d1dd6c8da9fedf4dd5447ab
Author: Duncan Overbruck <mail@duncano.de>
Date:   Tue Jan 28 20:03:56 2020 +0100

    lib/fetch: fix CVE-2020-7450

diff --git lib/fetch/fetch.c lib/fetch/fetch.c
index d0cce7b8..feaf768d 100644
--- lib/fetch/fetch.c
+++ lib/fetch/fetch.c
@@ -331,6 +331,8 @@ fetch_pctdecode(char *dst, const char *src, size_t dlen)
 		}
 		if (dlen-- > 0)
 			*dst++ = c;
+		else
+			return (NULL);
 	}
 	return (s);
 }
@@ -481,10 +483,14 @@ find_user:
 	if (p != NULL && *p == '@') {
 		/* username */
 		q = fetch_pctdecode(u->user, URL, URL_USERLEN);
+		if (q == NULL)
+			goto ouch;
 		/* password */
-		if (*q == ':')
+		if (*q == ':') {
 			q = fetch_pctdecode(u->pwd, q + 1, URL_PWDLEN);
-
+			if (q == NULL)
+				goto ouch;
+		}
 		p++;
 	} else {
 		p = URL;
