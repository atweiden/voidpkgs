maintainer="nox"
pkgname="python-soupsieve"
version=1.9.5
revision=2
short_desc="CSS4 selector implementation for Python2 Beautiful Soup"
archs="noarch"
hostmakedepends+=" python-setuptools"
hostmakedepends+=" python3-setuptools"
checkdepends+=" python-BeautifulSoup4"
checkdepends+=" python-backports.functools_lru_cache"
checkdepends+=" python-html5lib"
checkdepends+=" python-lxml"
checkdepends+=" python-pytest"
checkdepends+=" python3-BeautifulSoup4"
checkdepends+=" python3-html5lib"
checkdepends+=" python3-lxml"
checkdepends+=" python3-pytest"
homepage="https://facelessuser.github.io/soupsieve/"
license="MIT"
distfiles="$PYPI_SITE/s/soupsieve/soupsieve-$version.tar.gz"
checksum="e2c1c5dee4a1c36bcb790e0fabd5492d874b8ebd4617622c4f6a731701060dda"
wrksrc="soupsieve-$version"
build_style="python-module"
pycompile_module="soupsieve"

do_check() {
  PY2PATH="$PWD/build-2.7/lib"
  PY3PATH="$PWD/build-$py3_ver/lib"
  PYTHONPATH="$PY2PATH" python2 -m pytest
  PYTHONPATH="$PY3PATH" python3 -m pytest
}

post_install() {
  vlicense LICENSE.md

  # remove tests outside of the namespace
  rm -rf "$DESTDIR/$py3_sitelib/tests"
  rm -rf "$DESTDIR/$py2_sitelib/tests"
}

python3-soupsieve_package() {
  archs="noarch"
  pycompile_module="soupsieve"
  short_desc="${short_desc/Python2/Python3}"
  pkg_install() {
    vmove "usr/lib/python3*"
    vlicense LICENSE.md
  }
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
