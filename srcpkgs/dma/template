maintainer="Andy Weidenbaum <archbaum@gmail.com>"
pkgname="dma"
version=0.12
revision=1
short_desc="Small Mail Transport Agent (MTA), designed for home and office use"
makedepends="libressl-devel"
hostmakedepends="flex"
homepage="https://github.com/corecode/dma"
license="BSD-3-Clause"
distfiles="https://github.com/corecode/dma/archive/v$version.tar.gz>$pkgname-$version.tar.gz"
checksum="054a40203d43bc1182dcadf2375ccf01944329dce472444acb42d56cf01de367"
conf_files="/etc/dma/*.conf"
system_accounts="mail"
make_dirs="/var/spool/dma 2775 root mail"
provides+=" smtp-forwarder-0_1"
provides+=" smtp-server-0_1"
replaces+=" smtp-forwarder>=0"
replaces+=" smtp-server>=0"

do_build() {
  make \
    "$makejobs" \
    CC="$CC" \
    LEX="flex" \
    PREFIX="/usr" \
    SBIN="/usr/bin"
}

do_install() {
  vmkdir usr/bin
  make \
    PREFIX="/usr" \
    SBIN="/usr/bin" \
    DESTDIR="$DESTDIR" \
    sendmail-link \
    mailq-link \
    install-etc \
    install
}

post_install() {
  vlicense LICENSE
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
