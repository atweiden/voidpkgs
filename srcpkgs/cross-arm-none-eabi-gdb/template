_triplet="arm-none-eabi"
_pkgname="gdb"

maintainer="Andy Weidenbaum <archbaum@gmail.com>"
pkgname="cross-$_triplet-$_pkgname"
version=8.2.1
revision=1
short_desc="GNU Debugger"
makedepends+=" babeltrace-devel"
makedepends+=" expat-devel"
makedepends+=" mpfr-devel"
makedepends+=" ncurses-devel"
makedepends+=" readline-devel"
makedepends+=" zlib-devel"
makedepends+=" $(vopt_if guile guile-devel)"
makedepends+=" $(vopt_if python gettext-libs)"
makedepends+=" $(vopt_if python python3-devel)"
hostmakedepends+=" autoconf"
hostmakedepends+=" automake"
hostmakedepends+=" bison"
hostmakedepends+=" flex"
hostmakedepends+=" pkg-config"
license="GPL-3.0-or-later"
homepage="https://www.gnu.org/software/$_pkgname"
distfiles="$GNU_SITE/$_pkgname/$_pkgname-$version.tar.xz"
checksum="0a6a432907a03c5c8eaad3c3cffd50c00a40c3a5e3c4039440624bae703f2202"
wrksrc="$_pkgname-$version"
build_style="gnu-configure"
pycompile_dirs="/usr/share/$_pkgname"
configure_args+=" --disable-gdbserver"
configure_args+=" --disable-nls"
configure_args+=" --disable-werror"
configure_args+=" --host=$XBPS_CROSS_TRIPLE"
configure_args+=" --prefix=/usr"
configure_args+=" --target=$_triplet"
configure_args+=" --with-babeltrace"
configure_args+=" --with-expat"
configure_args+=" --with-mpfr"
configure_args+=" --with-system-readline"
configure_args+=" --with-system-zlib"
configure_args+=" --without-isl"
configure_args+=" $(vopt_with guile)"
configure_args+=" $(vopt_with python)"
build_options+=" guile"
build_options+=" python"
# don't enable guile and python interfaces until they are moved into
# platform independent packages
build_options_default=" "
nocross="yes"

post_install() {
  # resolve conflicts with binutils and native gdb
  rm -fr "$DESTDIR/usr"/{share/{locale,gdb,info},include}
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
