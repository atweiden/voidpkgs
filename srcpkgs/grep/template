maintainer="Andy Weidenbaum <archbaum@gmail.com>"
pkgname="grep"
version=3.1
revision=1
short_desc="The GNU grep utility"
makedepends="pcre-devel"
hostmakedepends+=" automake"
hostmakedepends+=" gettext-devel"
hostmakedepends+=" libtool"
hostmakedepends+=" pkg-config"
homepage="https://www.gnu.org/software/grep/"
license="GPL-3"
distfiles="$GNU_SITE/$pkgname/$pkgname-$version.tar.xz"
checksum="db625c7ab3bb3ee757b3926a5cfa8d9e1c3991ad24707a83dde8a5ef2bf7a07e"
build_style="gnu-configure"

pre_configure() {
  autoreconf -fi
}

pre_check() {
  case "$XBPS_TARGET_MACHINE" in
    *-musl)
      # disable locale tests that fail on musl
      sed \
        -i \
        -e '/test-localename$(EXEEXT)/d' \
        gnulib-tests/Makefile
      ;;
  esac
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
