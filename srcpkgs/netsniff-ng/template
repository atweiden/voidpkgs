maintainer="nox"
pkgname="netsniff-ng"
version=0.6.6
revision=2
short_desc="Free Linux networking toolkit"
makedepends+=" libcli-devel"
makedepends+=" libnet-devel"
makedepends+=" libnetfilter_conntrack-devel"
makedepends+=" libpcap-devel"
makedepends+=" libsodium-devel"
makedepends+=" liburcu-devel"
makedepends+=" ncurses-devel"
makedepends+=" zlib-devel"
hostmakedepends+=" bison"
hostmakedepends+=" flex"
hostmakedepends+=" pkg-config"
hostmakedepends+=" which"
homepage="http://netsniff-ng.org/"
license="GPL-3.0-or-later"
distfiles="http://pub.netsniff-ng.org/netsniff-ng/$pkgname-$version.tar.gz"
checksum="0a7092937209585b361400493d81ea1123a529494203824c0cd8e95562072c5e"
build_style="configure"
configure_args+=" --disable-geoip"
configure_args+=" --prefix=/usr"

CFLAGS="-fcommon"

post_extract() {
  vsed \
    -i \
    -e "s|/sbin|/bin|g" \
    Makefile
}

pre_configure() {
  export NACL_INC_DIR="$XBPS_CROSS_BASE/usr/include/sodium"
  export NACL_LIB="sodium"
  export NACL_LIB_DIR="$XBPS_CROSS_BASE/usr/lib"
}

do_build() {
  make \
    "$makejobs" \
    CC="$CC" \
    CFLAGS="$CFLAGS" \
    LD="$CC" \
    LDFLAGS="$LDFLAGS"
}

pre_install() {
  vmkdir usr/bin
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
