maintainer="nox"
pkgname="bc-gh"
version=6.2.2
revision=2
short_desc="Implementation of POSIX bc with GNU extensions"
homepage="https://git.yzena.com/gavin/bc"
license="BSD-2-Clause"
changelog="https://git.yzena.com/gavin/bc/raw/branch/master/NEWS.md"
distfiles="https://github.com/gavinhoward/bc/releases/download/$version/bc-$version.tar.xz"
checksum="5b6fe23b720ab898c9c9c9cbdc83e124791b0b575005ec91a63175d3b69b90f2"
alternatives+=" bc:bc.1:/usr/share/man/man1/bc-gh.1"
alternatives+=" bc:bc:/usr/bin/bc-gh"
alternatives+=" dc:dc.1:/usr/share/man/man1/dc-gh.1"
alternatives+=" dc:dc:/usr/bin/dc-gh"

# no translations in musl, because there is not a gencat binary there.

do_configure() {
  CC="$CC" \
  CFLAGS="$CFLAGS" \
  DESTDIR="$DESTDIR" \
  EXECSUFFIX="-gh" \
  HOSTCC="$CC_FOR_BUILD" \
  HOSTCFLAGS="$CFLAGS_FOR_BUILD" \
  PREFIX="/usr" \
    ./configure.sh \
      -GM \
      -pGNU \
      -sdc.tty_mode
}

do_build() {
  make "$makejobs"
}

do_check() {
  make "$makejobs" test
}

do_install() {
  # note that make install is used because of a symlink
  make install
  vman manuals/bc.1 bc-gh.1
  vman manuals/dc.1 dc-gh.1
  vlicense LICENSE.md
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
