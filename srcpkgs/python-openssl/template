maintainer="nox"
pkgname="python-openssl"
version=20.0.1
revision=2
short_desc="Python2 interface to the OpenSSL library"
depends+=" python-cryptography"
depends+=" python-six"
checkdepends+=" python3-cryptography"
checkdepends+=" python3-flaky"
checkdepends+=" python3-pretend"
checkdepends+=" python3-pytest"
checkdepends+=" python3-six"
hostmakedepends+=" python-setuptools"
hostmakedepends+=" python3-setuptools"
homepage="https://pyopenssl.org/"
license="Apache-2.0"
changelog="https://github.com/pyca/pyopenssl/raw/master/CHANGELOG.rst"
distfiles="$PYPI_SITE/p/pyOpenSSL/pyOpenSSL-$version.tar.gz"
checksum="4c231c759543ba02560fcd2480c48dcec4dae34c9da7d3747c508227e0624b51"
wrksrc="pyOpenSSL-$version"
build_style="python-module"

do_check() {
  PYTHONPATH="$(cd "build-$py3_ver"/lib* && pwd)" python3 -m pytest
}

python3-openssl_package() {
  unset depends
  depends+=" python3-cryptography"
  depends+=" python3-six"
  short_desc="${short_desc/Python2/Python3}"
  pkg_install() {
    vmove "usr/lib/python3*"
  }
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
