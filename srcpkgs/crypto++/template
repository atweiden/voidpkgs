maintainer="nox"
pkgname="crypto++"
version=820
revision=2
short_desc="Free C++ class library of cryptographic schemes"
hostmakedepends="unzip"
homepage="http://www.cryptopp.com/"
license="BSL-1.0"
distfiles="http://www.cryptopp.com/${pkgname/++/pp}$version.zip"
checksum="03f0e2242e11b9d19b28d0ec5a3fa8ed5cc7b27640e6bed365744f593e858058"
build_style="gnu-makefile"
make_build_args="PREFIX=/usr"
if [[ -n "$XBPS_CROSS" ]]; then
  make_build_args+=" -f GNUmakefile-cross"
fi
make_build_target+=" dynamic"
make_build_target+=" libcryptopp.pc"
make_build_target+=" static"
make_install_target="install-lib"
create_wrksrc="yes"

CXXFLAGS+=" -DNDEBUG"
CXXFLAGS+=" -fPIC"

post_extract() {
  sed \
    -i \
    -e 's/^CXXFLAGS/#CXXFLAGS/' \
    GNUmakefile
}

post_install() {
  vlicense License.txt LICENSE
}

crypto++-devel_package() {
  depends="$sourcepkg>=${version}_$revision"
  short_desc+=" - development files"
  pkg_install() {
    vmove usr/include
    vmove "usr/lib/*.a"
    vmove "usr/lib/*.so"
    vmove usr/lib/pkgconfig
  }
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
