# NOTE: keep this package synchronized with "srcpkgs/xbps"
maintainer="nox"
pkgname="xbps-static"
version=0.59
revision=1
short_desc="XBPS package system utilities - static binaries"
# only musl
archs="*-musl"
depends="xbps-triggers"
makedepends="libarchive-devel"
hostmakedepends="pkg-config"
homepage="https://www.voidlinux.org/xbps"
license="BSD-2-Clause"
changelog="https://github.com/void-linux/xbps/blob/master/NEWS"
distfiles="https://github.com/void-linux/xbps/archive/$version.tar.gz>$pkgname-$version.tar.gz"
checksum="4d4a67b40a6cc4994c2131c786fb17407ddc9041f4f5734b8a9c5d743ede46d0"
wrksrc="xbps-$version"
build_style="configure"

do_configure() {
  ./configure \
    --enable-static \
    --prefix="/usr" \
    --sysconfdir="/etc"
}

do_install() {
  make DESTDIR="$wrksrc/static-install" install
  vmkdir usr/bin
  mv "$wrksrc/static-install/usr/bin"/*.static "$DESTDIR/usr/bin"
}

post_install() {
  vlicense LICENSE
  vlicense LICENSE.3RDPARTY
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
