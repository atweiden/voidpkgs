maintainer="nox"
pkgname="tdb"
version=1.3.16
revision=1
short_desc="Trivial Database"
hostmakedepends+=" docbook-xsl"
hostmakedepends+=" libxslt"
hostmakedepends+=" pkg-config"
hostmakedepends+=" python"
homepage="https://tdb.samba.org/"
license="GPL-3.0-or-later"
distfiles="http://samba.org/ftp/tdb/$pkgname-$version.tar.gz"
checksum="6a3fc2616567f23993984ada3cea97d953a27669ffd1bfbbe961f26e0cf96cc5"
build_style="gnu-configure"

do_configure() {
  if [[ -n "$CROSS_BUILD" ]]; then
    cp "$FILESDIR/cross-32bit.answers" .
    sed \
      -i \
      -e "s,@@XBPS_TARGET_MACHINE@@,$XBPS_TARGET_MACHINE,g" \
      cross-32bit.answers
    _args+=" --cross-answers=cross-32bit.answers"
    _args+=" --cross-compile"
    _args+=" --hostcc=cc"
  fi
  ./configure \
    $_args \
    --disable-python \
    --prefix="/usr"
}

tdb-devel_package() {
  depends="libtdb-${version}_$revision"
  short_desc+=" - development files"
  pkg_install() {
    vmove usr/include
    vmove usr/lib/pkgconfig
    vmove "usr/lib/*.so"
  }
}

libtdb_package() {
  short_desc+=" - shared library"
  pkg_install() {
    vmove "usr/lib/*.so.*"
  }
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
