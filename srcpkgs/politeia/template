maintainer="nox"
pkgname="politeia"
version=1.4.0
revision=1
short_desc="Decred proposal system"
tags="decred"
homepage="https://github.com/decred/politeia"
license="ISC"
distfiles="https://github.com/decred/politeia/archive/v$version.tar.gz>$pkgname-$version.tar.gz"
checksum="c52dcb74dae6c03ec1f238200dae159be9d60d38dc53b8fc22a99c98f851c0cc"
build_style="go"
go_import_path="github.com/decred/politeia"
go_package+=" $go_import_path/politeiad"
go_package+=" $go_import_path/politeiad/cmd/politeia"
go_package+=" $go_import_path/politeiawww"
go_package+=" $go_import_path/politeiawww/cmd/cmswww"
go_package+=" $go_import_path/politeiawww/cmd/pictl"
go_package+=" $go_import_path/politeiawww/cmd/politeiaverify"
go_package+=" $go_import_path/politeiawww/cmd/politeiavoter"
go_package+=" $go_import_path/politeiawww/cmd/politeiawww_dbutil"
go_build_tags="netgo"
go_ldflags+=" -buildid="
go_ldflags+=" -X github.com/decred/politeia/util/version.BuildMetadata="
go_ldflags+=" -X github.com/decred/politeia/util/version.PreRelease="
go_ldflags+=" -extldflags=-static"

# XXX: -buildmode=pie is unverified on *-musl, and non-x86_64 or aarch64
export GOFLAGS="-trimpath -buildmode=pie"

post_install() {
  vlicense LICENSE
  vdoc README.md
  vcopy docs "usr/share/doc/$pkgname"
  vdoc politeiad/sample-politeiad.conf
  vdoc politeiawww/cmd/cmswww/sample-cmswww.conf
  vdoc politeiawww/cmd/pictl/sample-pictl.conf
  vdoc "$FILESDIR/sample-politeiavoter.conf"
  vdoc politeiawww/sample-politeiawww.conf
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
