maintainer="Andy Weidenbaum <archbaum@gmail.com>"
pkgname="s6"
version=2.9.0.0
revision=1
short_desc="Small suite of programs for UNIX, designed to allow process supervision"
makedepends+=" execline-devel"
makedepends+=" skalibs-devel"
homepage="http://skarnet.org/software/s6/"
license="ISC"
changelog="https://skarnet.org/software/s6/upgrade.html"
distfiles="http://skarnet.org/software/s6/$pkgname-$version.tar.gz"
checksum="1cac59bf9ff7c011b189ae2def3c76b147c2c431b0a901029fcaf957a6d9a343"
build_style="configure"
configure_args+=" --bindir=/usr/bin"
configure_args+=" --exec-prefix=/usr"
configure_args+=" --libdir=/usr/lib"
configure_args+=" --with-lib=$XBPS_CROSS_BASE/usr/lib"
configure_args+=" --with-sysdeps=$XBPS_CROSS_BASE/usr/lib/skalibs/sysdeps"

case "$XBPS_TARGET_MACHINE" in
  *-musl)
    makedepends+=" nsss-devel"
    configure_args+=" --enable-nsss"
    ;;
esac

post_install() {
  vlicense COPYING
  vdoc README
  vcopy "doc/*" "usr/share/doc/$pkgname"
}

s6-doc_package() {
  archs="noarch"
  short_desc="s6 supervision documentation"
  depends="$sourcepkg>=${version}_$revision"
  pkg_install() {
    vmove usr/share/doc
  }
}

s6-devel_package() {
  short_desc="s6 supervision library and headers"
  pkg_install() {
    vmove usr/include
    vmove "usr/lib/*.a"
  }
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
