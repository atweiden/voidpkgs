maintainer="nox"
pkgname="lsof"
version=4.98.0
revision=1
short_desc="LiSt Open Files"
checkdepends+=" procps-ng"
checkdepends+=" util-linux"
hostmakedepends="groff"
homepage="https://github.com/lsof-org/lsof"
license="custom:lsof"
changelog="https://github.com/lsof-org/lsof/raw/master/00DIST"
distfiles="https://github.com/lsof-org/lsof/releases/download/$version/$pkgname-$version.tar.gz"
checksum="2f8efa62cdf8715348b8f76bf32abf59f109a1441df35c686d23dccdeed34d99"
build_style="gnu-configure"
configure_args="--enable-security"

post_extract() {
  # fix github ci quirks
  if [[ $XBPS_BUILD_ENVIRONMENT == "void-packages-ci" ]]; then
    patch -Np1 < "$FILESDIR/fix-github-ci.patch"
  fi

  # ensure tests always run
  ln -sf /bin/true tests/CkTestDB
}

post_install() {
  vlicense COPYING
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
