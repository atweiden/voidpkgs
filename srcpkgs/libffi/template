maintainer="nox"
pkgname="libffi"
version=3.3
revision=1
short_desc="Library supporting Foreign Function Interfaces"
checkdepends="dejagnu"
homepage="http://sourceware.org/libffi"
license="MIT"
distfiles="ftp://sourceware.org/pub/libffi/$pkgname-$version.tar.gz"
checksum="72fba7922703ddfa7a028d513ac15a85c8d54c8d67f55fa5a4802885dc652056"
build_style="gnu-configure"
configure_args+=" --includedir=/usr/include"
configure_args+=" --with-pic"

pre_install() {
  vmkdir usr/lib
  ln -s lib "$DESTDIR/usr/lib64"
}

post_install() {
  # fix includedir for pkg-config file
  vsed \
    -i \
    -e "s|\${libdir}/libffi-$version|/usr|" \
    "$DESTDIR/usr/lib/pkgconfig/libffi.pc"
  vlicense LICENSE
  rm -f "$DESTDIR/usr/lib64"
}

libffi-devel_package() {
  depends="libffi>=${version}_$revision"
  short_desc+=" - development files"
  pkg_install() {
    vmove usr/include
    vmove "usr/lib/*.a"
    vmove "usr/lib/*.so"
    vmove usr/lib/pkgconfig
    vmove usr/share
  }
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
