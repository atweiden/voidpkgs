maintainer="nox"
pkgname="tin"
version=2.4.3
revision=2
short_desc="NNTP and spool based UseNet newsreader"
makedepends+=" libidn-devel"
makedepends+=" ncurses-devel"
makedepends+=" pcre-devel"
makedepends+=" readline-devel"
hostmakedepends+=" flex"
hostmakedepends+=" pcre-devel"
homepage="http://www.tin.org"
license="BSD-3-Clause"
distfiles="ftp://ftp.tin.org/pub/news/clients/tin/v${version%.*}/tin-$version.tar.xz"
checksum="cb1dc96cc61dcd12ad2e047ae41f4328fb424571fa3d8105dd700d71fada42aa"
build_style="gnu-configure"
configure_args+=" --enable-ipv6"
configure_args+=" --with-pcre=$XBPS_CROSS_BASE/usr"
make_build_target="build"
make_build_args="BUILD_LDFLAGS="

pre_configure() {
  sed \
    -i \
    -e '/BUILD_CPPFLAGS.*=/s/$(PCRE_CPPFLAGS)//' \
    src/Makefile.in
}

post_install() {
  # conflicts with mutt
  rm -f "$DESTDIR/usr/share/man/man5"/{mmdf.5,mbox.5}
  # missing license file
  sed -n 9,34p src/misc.c >LICENSE
  vlicense LICENSE
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
