maintainer="nox"
pkgname="geoip-data"
version=20171002
revision=2
short_desc="Non-DNS IP-to-country resolver C library and utilities (data files)"
homepage="https://dev.maxmind.com/geoip/legacy/geolite/"
license="CC-BY-SA-4.0"
create_wrksrc="yes"
archs="noarch"

do_fetch() {
  $XBPS_FETCH_CMD http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz
  $XBPS_FETCH_CMD http://geolite.maxmind.com/download/geoip/database/GeoIPv6.dat.gz
  $XBPS_FETCH_CMD http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz
  $XBPS_FETCH_CMD http://geolite.maxmind.com/download/geoip/database/GeoLiteCityv6-beta/GeoLiteCityv6.dat.gz
  $XBPS_FETCH_CMD http://download.maxmind.com/download/geoip/database/asnum/GeoIPASNum.dat.gz
  $XBPS_FETCH_CMD http://download.maxmind.com/download/geoip/database/asnum/GeoIPASNumv6.dat.gz
}

do_install() {
  vmkdir usr/share/GeoIP
  for f in GeoIP \
           GeoIPASNum \
           GeoIPASNumv6 \
           GeoIPv6 \
           GeoLiteCity \
           GeoLiteCityv6; do
    zcat "../$f.dat.gz" > "$f.dat"
    rm -f "../$f.dat.gz"
    vinstall "$f.dat" 644 usr/share/GeoIP
  done
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
