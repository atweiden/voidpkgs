maintainer="nox"
pkgname="flake8"
version=3.9.2
revision=1
short_desc="Modular source code checker: pycodestyle, pyflakes, mccabe"
depends+=" python3-mccabe"
depends+=" python3-pycodestyle"
depends+=" python3-pyflakes"
checkdepends+=" $depends"
checkdepends+=" python3-mock"
checkdepends+=" python3-pytest"
hostmakedepends="python3-setuptools"
homepage="https://gitlab.com/pycqa/flake8"
license="MIT"
changelog="https://github.com/PyCQA/flake8/raw/master/docs/source/release-notes/$version.rst"
distfiles="$PYPI_SITE/f/flake8/flake8-$version.tar.gz"
checksum="07528381786f2a6237b061f6e96610a4167b226cb926e2aa2b6b1d78057c576b"
build_style="python3-module"

do_check() {
  # from alpine
  PYTHONPATH="build/lib" python3 -m pytest \
    --deselect="tests/integration/test_api_legacy.py::test_legacy_api" \
    --deselect="tests/integration/test_main.py" \
    --deselect="tests/integration/test_plugins.py" \
    --deselect="tests/unit/test_setuptools_command.py::test_package_files_removes_submodules"
}

post_install() {
  vlicense LICENSE
}

python3-flake8_package() {
  build_style=meta
  short_desc+=" (transitional dummy package)"
  depends="flake8>=${version}_$revision"
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
