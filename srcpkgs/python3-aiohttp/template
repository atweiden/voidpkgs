maintainer="nox"
pkgname="python3-aiohttp"
version=3.7.4
revision=5
short_desc="HTTP client/server for asyncio (PEP-3156)"
depends+=" python3-async-timeout"
depends+=" python3-attrs"
depends+=" python3-chardet"
depends+=" python3-multidict"
depends+=" python3-typing_extensions"
depends+=" python3-yarl"
makedepends+=" http-parser-devel"
makedepends+=" python3-devel"
hostmakedepends="python3-setuptools"
homepage="https://aiohttp.readthedocs.io/"
license="Apache-2.0"
distfiles="$PYPI_SITE/a/aiohttp/aiohttp-$version.tar.gz"
checksum="5d84ecc73141d0a0d61ece0742bb7ff5751b0657dab8405f899d3ceb104cc7de"
build_style="python3-module"

post_patch() {
  # use system http-parser
  vsed \
    -i \
    -e '/http_parser\.c/d' \
    setup.py
  vsed \
    -i \
    -e '/http_parser\.h/s/".*\//"/' \
    aiohttp/_cparser.pxd
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
