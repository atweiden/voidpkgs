maintainer="nox"
pkgname="talloc"
version=2.3.1
revision=1
short_desc="Hierarchical pool based memory allocator with destructors"
hostmakedepends+=" docbook-xsl"
hostmakedepends+=" libxslt"
hostmakedepends+=" pkg-config"
hostmakedepends+=" python3"
homepage="https://talloc.samba.org/"
license="GPL-3.0-or-later"
distfiles="http://samba.org/ftp/talloc/$pkgname-$version.tar.gz"
checksum="ef4822d2fdafd2be8e0cabc3ec3c806ae29b8268e932c5e9a4cd5585f37f9f77"
build_style="configure"

do_configure() {
  if [[ -n "$CROSS_BUILD" ]]; then
    cp "$FILESDIR/cross-32bit.answers" .
    _args+=" --cross-answers=cross-32bit.answers"
    _args+=" --cross-compile"
    _args+=" --hostcc=$CC"
  fi
  ./configure \
    $_args \
    --disable-python \
    --prefix="/usr"
}

talloc-devel_package() {
  depends="$sourcepkg-${version}_$revision"
  short_desc+=" - development files"
  pkg_install() {
    vmove usr/include
    vmove usr/lib/pkgconfig
    vmove usr/lib/libtalloc.so
    vmove usr/share/man/man3
  }
}

# vim: set filetype=sh foldmethod=marker foldlevel=0 nowrap:
